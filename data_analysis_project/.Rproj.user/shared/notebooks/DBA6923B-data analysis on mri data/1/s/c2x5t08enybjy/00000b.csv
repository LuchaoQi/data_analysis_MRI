"0","#PCA after getting rid of CSF"
"0","library(compositions)"
"0","library(factoextra)"
"0","dat_age_noCSF = list()"
"0","#compositional analysis"
"0","for(i in Age){"
"0","  dat_age_noCSF[[i]] = dat_age[[i]] %>%"
"0","    select(-CSF) %>% acomp()"
"0","}"
"0","res.pca = list()"
"0","res.rotations_noCSF = list()"
"0","PC = c(""PC1"",""PC2"",""PC3"")"
"0","for(j in PC){"
"0","  for(i in Age){"
"0","  res.pca[[i]] = prcomp(dat_age_noCSF[[i]],scale. = T)"
"0","  dat_visualization = prop.table(abs(res.pca[[i]]$rotation),margin = 2) %>% melt()"
"0","  colnames(dat_visualization) = c('roi','PC','value')"
"0","  "
"0","  #further work on PC1"
"0","  res.rotations_noCSF[[i]] = dat_visualization %>% filter(PC == j)"
"0","  "
"0","  }"
"0","  res.rotations_noCSF$compile = c()"
"0","  for (i in Age){"
"0","  res.rotations_noCSF$compile = rbind(res.rotations_noCSF$compile, "
"0","                                      select(res.rotations_noCSF[[i]],c(roi,value)) "
"0","                                      %>% mutate(Age = i))"
"0","  }"
"0","  print("
"0","  ggplot(res.rotations_noCSF$compile, aes(x = Age,y = value,colour = roi,group = roi)) + "
"0","  geom_line() + "
"0","  labs(title = paste('Compositional analysis: weight of roi in',j))"
"0","  )"
"0","}"




```{r}
############################################################
# by() function
# https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&mid=2247490048&idx=1&sn=f79c7f9846515b8b588fefb135941f11&chksm=9b485abbac3fd3ad9c6432e3499882ce3a7cc460de9aacecb044745b310b660bec3ccca5cfe5&mpshare=1&scene=1&srcid=&key=bbe6b9114c051855c6e05c5f6a5dc16d5addeee60f7ac2d928317c33a17c5a647777eb26dd5d98532d1628085ee72a0a7eb83e2b7f5b3dc8f9c842ddd80609bbb2a627c9df7c7893b11d41fddf3a7011&ascene=1&uin=NzA3NTE3MTMz&devicetype=Windows+10&version=62060739&lang=en&pass_ticket=BtEL1XKYSfD1qCReMjnXodlolddB4kzH3wnV2pDFI0ABdnNAi32nzLgFOVceqYYQ
############################################################

data("Titanic")
library(data.table)
# transforming from class table to dataframe
dtTitanic = data.table(Titanic)
colnames(dtTitanic)[5] = "Freq"



#impact of one feature

############################################################
# by() a super useful way to summarize the dataframe
# no need to use table()
############################################################



dtClass <- dtTitanic[, list(n=sum(Freq)), by=c('Survived',
'Class')]
dtClass[, percentage := n / sum(n), by='Class']
dtClass[, textPercentage := paste(round(percentage * 100), '%',
sep='')]
barplot(
height=dtClass[Survived == 'Yes', percentage],
names.arg=dtClass[Survived == 'Yes', Class],
# col=dtClass[Survived == 'Yes', Class],
ylim=c(0, 1),
legend.text=dtClass[Survived == 'Yes', textPercentage],
ylab='survival rate',
main='Survival rate by class'
)


#the impact of two features combined
dtGenderFreq <- dtTitanic[, list(n=sum(Freq)), by=c('Sex', 'Class')]
dtGenderFreq[, percentage := n / sum(n), by='Class']
dtGenderFreq <- dtGenderFreq[Sex == 'Female']
dtGenderFreq[, textPercentage := paste(round(percentage * 100), '%',
sep='')]
barplot(
height=dtGenderFreq[, percentage],
names.arg=dtGenderFreq[, Class],
# col=dtGenderFreq[, Class],
ylim=c(0, 1),
legend.text=dtGenderFreq[, textPercentage],
ylab='survival rate',
main='Percentage of females'
)
```

